<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>liblarod: How to setup larod to use powerd</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="axis-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">liblarod
   &#160;<span id="projectnumber">3.2.254-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to setup larod to use powerd </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em>For documentation of how power management works in larod in general, refer to <a href="introduction-for-app-developers.md#power-management">introduction-for-app-developers.md</a>.</em></p>
<p>In order to enable larod to work with powerd, some configurations need to be set up for the system; in detail, these are the steps that need to be done:</p>
<ol type="1">
<li>Identify which hardware units are to be used by larod and also should be registered as power consumers to powerd. This could for instance be the DLPU on an ARTPEC chip. larod supports the following (case sensitive) <em>hardware-unit identifiers</em>:<ul>
<li><code>ace</code></li>
<li><code>cpu</code></li>
<li><code>dlpu</code></li>
<li><code>gpu</code></li>
<li><code>tpu</code></li>
</ul>
</li>
<li>powerd must be configured to accept the power-consuming hardware units that larod intends to use. This is done by adding separate entries for each of the <em>hardware-unit identifiers</em> in the product's powerd configuration file; this is done in the <a href="https://gittools.se.axis.com/gerrit/admin/repos/packages/powerd/common,general"><em>powerd-conf</em></a> repo.</li>
<li><p class="startli">A JSON configuration file must be in place such that larod's power controller can know which devices need to be registered to powerd and how much power they consume when running. This file needs to be added to the <em>meta-axis-bsp</em> repo under <code>conf/machine/product-config/larod-conf</code>. Refer to the README file there and examples of how this config file could look.</p>
<p class="startli">Below is an example of a fictitious product which has a DLPU and a TPU that consume up to 2 W and 3 W respectively. Its configuration file would look like this:</p>
</li>
</ol>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;devices&quot;: [</div><div class="line">        {</div><div class="line">            &quot;name&quot;: &quot;dlpu&quot;,</div><div class="line">            &quot;power&quot;: 2.0</div><div class="line">        },</div><div class="line">        {</div><div class="line">            &quot;name&quot;: &quot;tpu&quot;,</div><div class="line">            &quot;power&quot;: 3.0</div><div class="line">        }</div><div class="line">    ]</div><div class="line">}</div></div><!-- fragment --><ol type="1">
<li>Add the following to your machine conf in <code>meta-axis-bsp/conf/machine</code>:</li>
</ol>
<div class="fragment"><div class="line">PACKAGECONFIG:append:pn-larod = &quot; powerd&quot;</div></div><!-- fragment --><p>If these steps have been done correctly, the larod service will connect to powerd on startup and make sure that powerd grants power before doing any power-consuming work on the specified hardware units. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2009-2025 Axis Communications AB. All rights reserved.
</small></address>
</body>
</html>
