<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>liblarod: Preprocessing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">liblarod
   &#160;<span id="projectnumber">@VERSION_STR@</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Preprocessing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#what-is-preprocessing">What is preprocessing?</a></li>
<li><a href="#preprocessing-job-configuration">Preprocessing job configuration</a><ul>
<li><a href="#common-operations">Common operations</a></li>
<li><a href="#common-configuration-parameters">Common configuration parameters</a></li>
</ul>
</li>
<li><a href="#supported-backends">Supported backends</a><ul>
<li><a href="#libyuv-backend">libyuv backend</a></li>
<li><a href="#ace-backend">ACE backend</a></li>
<li><a href="#vproc-backend">VProc backend</a></li>
<li><a href="#opencl-backend">OpenCL backend</a></li>
</ul>
</li>
<li><a href="#supported-operations">Supported operations</a></li>
<li><a href="#supported-formats">Supported formats</a><ul>
<li><a href="#operations-requiring-a-color-format-conversion">Operations requiring a color format conversion</a></li>
<li><a href="#operations-not-requiring-a-color-format-conversion">Operations <em>not</em> requiring a color format conversion</a></li>
</ul>
</li>
<li><a href="#supported-buffer-properties">Supported buffer properties</a><ul>
<li><a href="#when-running-jobs">When running jobs</a></li>
<li><a href="#when-allocating-tensors">When allocating tensors</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md57"></a>
What is preprocessing?</h1>
<p>Preprocessing in larod can be used to process input data so that it has the format, size and shape a neural network expects. For optimal performance the processing operations can be offloaded to specialized preprocessing hardware. Each supported preprocessing hardware accelerator is exposed to applications through a backend (<code>larodChip</code>) in larod.</p>
<p>Currently only image processing operations are supported.</p>
<h1><a class="anchor" id="autotoc_md58"></a>
Preprocessing job configuration</h1>
<p>Preprocessing jobs are configured with key-value parameters in a <code>larodMap</code>. The configuration describes the data that you have and how you want the data to be. The selected backend will crop, scale and convert according to what the description requires.</p>
<p>Below is an example job configuration. It describes a job that takes a 1280x720 input image in NV12 format, crops out 200x200 from the center of the image (X offset 540 and Y offset 260), converts it to the RGB interleaved format and scales it down to 48x48. In this case the <a href="#libyuv-backend">libyuv backend</a> will be used to perform these operations. In the interest of brevity error handling has been omitted.</p>
<div class="fragment"><div class="line"><a class="code" href="larod_8h.html#a480ba7618e79ad250c166c52d216ab79">larodMap</a>* modelParams = <a class="code" href="larod_8h.html#ac7cb26c7b2ef5c99507edd44e7727b0e">larodCreateMap</a>(NULL);</div>
<div class="line"><a class="code" href="larod_8h.html#a28e4db02130ffb4c0a19fac84b698ce0">larodMapSetStr</a>(modelParams, <span class="stringliteral">&quot;image.input.format&quot;</span>, <span class="stringliteral">&quot;nv12&quot;</span>, NULL);</div>
<div class="line"><a class="code" href="larod_8h.html#a3e5686f34427aaa1a2476cc0991adf12">larodMapSetIntArr2</a>(modelParams, <span class="stringliteral">&quot;image.input.size&quot;</span>, 1280, 720, NULL);</div>
<div class="line"><a class="code" href="larod_8h.html#a28e4db02130ffb4c0a19fac84b698ce0">larodMapSetStr</a>(modelParams, <span class="stringliteral">&quot;image.output.format&quot;</span>, <span class="stringliteral">&quot;rgb-interleaved&quot;</span>, NULL);</div>
<div class="line"><a class="code" href="larod_8h.html#a3e5686f34427aaa1a2476cc0991adf12">larodMapSetIntArr2</a>(modelParams, <span class="stringliteral">&quot;image.output.size&quot;</span>, 48, 48, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Our modelParams larodMap replaces the model fd as a model description.</span></div>
<div class="line"><a class="code" href="larod_8h.html#a9e56e66ffecad46856d96bc289b6ce5a">larodModel</a> *model = <a class="code" href="larod_8h.html#a9617def81b934a2219d6a8f2a6ccdf7f">larodLoadModel</a>(conn, -1, <a class="code" href="larod_8h.html#a5d61d65903803a3c587e5830de34df24a0444d4c3c924311308e7bd61479dc99d">LAROD_CHIP_LIBYUV</a>,</div>
<div class="line">                                   <a class="code" href="larod_8h.html#a41ad6dc8e9f9ffebc03faf115167aba5afc936d97349d892279eec5c41c154d41">LAROD_ACCESS_PRIVATE</a>, <span class="stringliteral">&quot;&quot;</span>, modelParams, NULL);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="larod_8h.html#a480ba7618e79ad250c166c52d216ab79">larodMap</a>* jobParams = <a class="code" href="larod_8h.html#ac7cb26c7b2ef5c99507edd44e7727b0e">larodCreateMap</a>(NULL);</div>
<div class="line"><span class="comment">// We can change the value of &quot;image.input.crop&quot; in our map between running jobs</span></div>
<div class="line"><span class="comment">// on the same model if we wish.</span></div>
<div class="line"><a class="code" href="larod_8h.html#ab008dee48f6d1625ed351899492c53f1">larodMapSetIntArr4</a>(jobParams, <span class="stringliteral">&quot;image.input.crop&quot;</span>, 540, 260, 200, 200, NULL);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="larod_8h.html#a8f6f0898b3a3c25a07582687b6095265">larodJobRequest</a>* jobReq = <a class="code" href="larod_8h.html#af25e0293b11b12fb8e296fb20c828159">larodCreateJobRequest</a>(...);</div>
<div class="line"><a class="code" href="larod_8h.html#aa6ff7fdb5a6d524d366c16df6856849f">larodSetJobRequestParams</a>(jobReq, jobParams, NULL);</div>
<div class="line"><a class="code" href="larod_8h.html#a7c492dcfb18e0a32407dc6078bd50dbe">larodRunJob</a>(conn, jobReq, NULL);</div>
</div><!-- fragment --><p>Note that should one be interested in just scaling the original image (from 1280x720 to 48x48) without cropping it first, one could simply neglect to provide a <code>larodMap</code> altogether in the <code>larodJobRequest</code> used.</p>
<h2><a class="anchor" id="autotoc_md59"></a>
Common operations</h2>
<p>Image preprocessing backends may support the following common image processing operations. Backends are not required to support all operations and image formats.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Operation </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Image crop </td><td class="markdownTableBodyNone">Crop out a part of an image.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Image scale </td><td class="markdownTableBodyNone">Scale up or down an image.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Image convert </td><td class="markdownTableBodyNone">Convert an image between two color formats.  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md60"></a>
Common configuration parameters</h2>
<p>Image preprocessing backends may support the common image processing parameters in the tables below to describe processing jobs. Backends are not required to support all parameters and values.</p>
<h3><a class="anchor" id="autotoc_md61"></a>
Load model parameters</h3>
<p>The following are parameters that can be set on a <code>larodMap</code> provided when loading a model using e.g. <code>larodLoadModel</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">image.input.format* </td><td class="markdownTableBodyNone">String, describing input image format.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">image.input.size* </td><td class="markdownTableBodyNone">2-integer-tuple, describing input image width and height.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">image.input.row-pitch </td><td class="markdownTableBodyNone">Integer, describing input image width including padding, in bytes. Inferred if not explicilty given.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">image.output.format* </td><td class="markdownTableBodyNone">String, describing output image format.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">image.output.size* </td><td class="markdownTableBodyNone">2-integer-tuple, describing output image width and height.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">image.output.row-pitch </td><td class="markdownTableBodyNone">Integer, describing output image width including padding, in bytes. Inferred if not explicitly given.  </td></tr>
</table>
<p>*: This parameter is mandatory for all preprocessing backends outlined in this document.</p>
<h3><a class="anchor" id="autotoc_md62"></a>
Job request parameters</h3>
<p>The following are parameters that can be set on a <code>larodMap</code> of a <code>larodJobRequest</code>. The map can be attached to a job request upon its creation (<code>larodCreateJobRequest</code>) or later using <code>larodSetJobRequestParams</code>. The parameters of the map will then be used in a subsequent call to e.g. <code>larodRunJob</code> using this job request.</p>
<p>Since these parameters are not attached to a model it's possible to send job requests having larodMaps with different values for these parameters to the same model.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">image.input.crop </td><td class="markdownTableBodyNone">4-integer-tuple, describing the crop window. The elements in the tuple are: X offset in input image, Y offset in input image, crop window width, crop window height.  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md63"></a>
Supported backends</h1>
<p>Currently the following image preprocessing backends are supported by larod.</p>
<h2><a class="anchor" id="autotoc_md64"></a>
libyuv backend</h2>
<p>The libyuv backend uses the open source library <a href="https://chromium.googlesource.com/libyuv/libyuv/">libyuv</a>. It runs on most CPUs and in particular uses the SIMD technology Neon on Arm architectures to accelerate parallelizable computation. It supports image crop, scale and format conversion.</p>
<p>This backend is represented by the <code>larodChip</code> <code>LAROD_CHIP_LIBYUV</code> in <code><a class="el" href="larod_8h.html" title="Main larod header file.">larod.h</a></code>.</p>
<h3><a class="anchor" id="autotoc_md65"></a>
libyuv backend constraints</h3>
<ul>
<li>The width, height and row pitch, for both the input and the output image, must be a multiple of 2.</li>
</ul>
<h3><a class="anchor" id="autotoc_md66"></a>
Supported buffer properties for running jobs</h3>
<p>This backend only supports the fd access types <code>LAROD_FD_PROP_MAP</code> and <code>LAROD_FD_PROP_READWRITE</code>.</p>
<p>As the name indicates the former fd prop will allow the libyuv backend to map (using <code>mmap</code>) the tensor's file descriptor instead of reading or writing from them. Combined with tensor tracking (e.g. using <code>larodTrackTensor</code>) the libyuv backend may be able to cache a tensor's mapping and thus allow for a very efficient zero-copy map-once memory access pattern.</p>
<p>The access type <code>LAROD_FD_PROP_READWRITE</code> will introduce a memory copy and <code>read()</code>/<code>write()</code> calls for each input and output tensor buffer - these extra operations will degrade performance.</p>
<h3><a class="anchor" id="autotoc_md67"></a>
Allocation support</h3>
<p>Tensors allocated using the calls <code><a class="el" href="larod_8h.html#ad8be991c1295938b95df0c2dbd6d1ad7" title="Create and allocate input tensors from a model.">larodAllocModelInputs()</a></code> and <code><a class="el" href="larod_8h.html#a39c2cd5fb8f2395f976cc49220e96888" title="Create and allocate output tensors from a model.">larodAllocModelOutputs()</a></code> with a model loaded to this backend will have file descriptors that are readable, writable and mappable. Accordingly the tensors will have the fd props <code>LAROD_FD_PROP_READWRITE</code> and <code>LAROD_FD_PROP_MAP</code> set.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
ACE backend</h2>
<p>The ACE backend uses Axis Compute Engine in Axis ARTPEC series chips. It only supports image format conversion.</p>
<p>This backend is represented by the <code>larodChip</code> <code>LAROD_CHIP_ACE</code> in <code><a class="el" href="larod_8h.html" title="Main larod header file.">larod.h</a></code>.</p>
<h3><a class="anchor" id="autotoc_md69"></a>
ACE backend constraints</h3>
<ul>
<li>The input image width must be a multiple of 8.</li>
<li>The input image height must be 4 or larger.</li>
<li>The input image row pitch must be equal to input image width.</li>
<li>The output image row pitch must be equal to output image width.</li>
</ul>
<h3><a class="anchor" id="autotoc_md70"></a>
Supported buffer properties for running jobs</h3>
<p>This backend only supports the fd access types <code>LAROD_FD_PROP_MAP</code> and <code>LAROD_FD_PROP_READWRITE</code>.</p>
<p>As the name indicates the former fd prop will allow the ACE backend to map (using <code>mmap</code>) the tensor's file descriptor instead of reading or writing directly from it. Combined with tensor tracking (e.g. using <code>larodTrackTensor</code>) the ACE backend may be able to cache a tensor's mapping. The backend does not support zero copy, meaning that data will still be copied from the memory mapping to the actual buffer for the job.</p>
<p>The access type <code>LAROD_FD_PROP_READWRITE</code> will do a memory copy through <code>read()</code>/<code>write()</code> calls for each input and output tensor buffer - these extra operations will degrade performance.</p>
<h3><a class="anchor" id="autotoc_md71"></a>
Allocation support</h3>
<p>Tensors allocated using the calls <code><a class="el" href="larod_8h.html#ad8be991c1295938b95df0c2dbd6d1ad7" title="Create and allocate input tensors from a model.">larodAllocModelInputs()</a></code> and <code><a class="el" href="larod_8h.html#a39c2cd5fb8f2395f976cc49220e96888" title="Create and allocate output tensors from a model.">larodAllocModelOutputs()</a></code> with a model loaded to this backend will have file descriptors that are readable, writable and mappable. Accordingly the tensors will have the fd props <code>LAROD_FD_PROP_READWRITE</code> and <code>LAROD_FD_PROP_MAP</code> set.</p>
<h2><a class="anchor" id="autotoc_md72"></a>
VProc backend</h2>
<p>The VProc backend uses VPROC in Ambarella CV series chips. It supports image crop, scale and format conversion.</p>
<p>This backend is represented by the <code>larodChip</code> <code>LAROD_CHIP_CVFLOW_PROC</code> in <code><a class="el" href="larod_8h.html" title="Main larod header file.">larod.h</a></code>.</p>
<h3><a class="anchor" id="autotoc_md73"></a>
VProc backend constraints</h3>
<ul>
<li>The input image width must be a multiple of 2 when input format is nv12.</li>
<li>The input image height must be a multiple of 2 when input format is nv12.</li>
<li>The input image row pitch must be a multiple of 32.</li>
<li>The output image width must be a multiple of 2 when output format is nv12.</li>
<li>The output image height must be a multiple of 2 when output format is nv12.</li>
<li>The output image row pitch must be a multiple of 32.</li>
<li>For operations requiring both color format conversion and scaling the scale factor must be at most 4.</li>
<li>For operations <em>not</em> requiring color format conversion the scale factor must be at most 256.</li>
</ul>
<h3><a class="anchor" id="autotoc_md74"></a>
Supported buffer properties for running jobs</h3>
<p>This backend supports the fd access types <code>LAROD_FD_PROP_DMABUF</code> and <code>LAROD_FD_PROP_READWRITE</code>.</p>
<p>The access type <code>LAROD_FD_PROP_DMABUF</code> provides less overhead since the buffer will be passed directly the underlying processing framework without extra copies in larod. When using <code>LAROD_FD_PROP_DMABUF</code> the input tensor buffers will have CPU cache flushed before the processing starts, and output buffers buffers will have cache invalidated before the results are delivered to the application. Note that the supplied dmabufs must be allocated by the Ambarella platform.</p>
<p>The access type <code>LAROD_FD_PROP_READWRITE</code> will introduce a memory copy and <code>read()</code>/<code>write()</code> calls for each input and output tensor buffer - these extra operations will degrade performance.</p>
<h3><a class="anchor" id="autotoc_md75"></a>
Allocation support</h3>
<p>Using the calls <code><a class="el" href="larod_8h.html#ad8be991c1295938b95df0c2dbd6d1ad7" title="Create and allocate input tensors from a model.">larodAllocModelInputs()</a></code> and <code><a class="el" href="larod_8h.html#a39c2cd5fb8f2395f976cc49220e96888" title="Create and allocate output tensors from a model.">larodAllocModelOutputs()</a></code> with a model loaded to this backend two kinds of tensor buffers can be allocated. If the <code>LAROD_FD_PROP_READWRITE</code> is <em>not</em> set as required in the call, then tensors with mappable file descriptors based on Cavalry Mem dma-bufs will be returned. As such these tensors will have the fd props <code>LAROD_FD_PROP_MAP</code> and <code>LAROD_FD_PROP_DMABUF</code> set. If however <code>LAROD_FD_PROP_READWRITE</code> is required, then tensors with readable, writable and mappable file descriptors will be returned. As such these tensors will have the fd props <code>LAROD_FD_PROP_READWRITE</code> and <code>LAROD_FD_PROP_MAP</code> set.</p>
<h2><a class="anchor" id="autotoc_md76"></a>
OpenCL backend</h2>
<p>OpenCL is a compute framework which enables programmers to write programs that execute across heterogeneous platforms such as CPUs, GPUs and more. larod contains predefined OpenCL programs which lets a larod user through its OpenCL backend conveniently run image crop, scale and format conversion.</p>
<p>The platform larod runs on may have several devices supporting the OpenCL framework. larod can run its operations on any of these devices but will choose the device with the lowest <code>cl_device_id</code> by default. See instructions below for how to choose a specific device for larod to run its OpenCL operations on.</p>
<p>This backend is represented by the <code>larodChip</code> <code>LAROD_CHIP_OPENCL</code> in <code><a class="el" href="larod_8h.html" title="Main larod header file.">larod.h</a></code>.</p>
<h3><a class="anchor" id="autotoc_md77"></a>
Choosing a specific device</h3>
<p>When loading a model onto the OpenCL backend there is an additional key that one can put in the <code>larodMap</code>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">device </td><td class="markdownTableBodyNone">String specifying which OpenCL device to use.  </td></tr>
</table>
<p>The device value string will be matched to the list of OpenCL devices available on the platform when loading a model, and use the matched device for the model's OpenCL operations. Note that a partial match will suffice.</p>
<h3><a class="anchor" id="autotoc_md78"></a>
OpenCL devices on Axis product platforms</h3>
<p>Currently the OpenCL backend is supported on two of the SoCs used in Axis products, namely Artpec-7 and Artpec-8. On platforms using these SoCs a larod user can choose among the following values for <code>"device"</code> to run on either GPU or DLPU:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">SoC </th><th class="markdownTableHeadNone">"device" value for GPU </th><th class="markdownTableHeadNone">"device" value for DLPU  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Artpec-7 </td><td class="markdownTableBodyNone">GC </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Artpec-8 </td><td class="markdownTableBodyNone">GC </td><td class="markdownTableBodyNone">VIP  </td></tr>
</table>
<p>For example, setting </p><div class="fragment"><div class="line"><a class="code" href="larod_8h.html#a28e4db02130ffb4c0a19fac84b698ce0">larodMapSetStr</a>(modelParams, <span class="stringliteral">&quot;device&quot;</span>, <span class="stringliteral">&quot;GC&quot;</span>, NULL);</div>
</div><!-- fragment --><p>will load the model onto the GPU of any product based on Artpec-7 or Artpec-8.</p>
<h3><a class="anchor" id="autotoc_md79"></a>
Supported buffer properties for running jobs</h3>
<p>This backend only supports the fd access type <code>LAROD_FD_PROP_READWRITE</code>.</p>
<h3><a class="anchor" id="autotoc_md80"></a>
Allocation support</h3>
<p>Tensors allocated using the calls <code><a class="el" href="larod_8h.html#ad8be991c1295938b95df0c2dbd6d1ad7" title="Create and allocate input tensors from a model.">larodAllocModelInputs()</a></code> and <code><a class="el" href="larod_8h.html#a39c2cd5fb8f2395f976cc49220e96888" title="Create and allocate output tensors from a model.">larodAllocModelOutputs()</a></code> with a model loaded to this backend will have file descriptors that are readable, writable and mappable. Accordingly the tensors will have the fd props <code>LAROD_FD_PROP_READWRITE</code> and <code>LAROD_FD_PROP_MAP</code> set.</p>
<h1><a class="anchor" id="autotoc_md81"></a>
Supported operations</h1>
<p>The following table describes supported operations for each backend.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">crop </th><th class="markdownTableHeadNone">convert </th><th class="markdownTableHeadNone">scale  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md82"></a>
Supported formats</h1>
<h2><a class="anchor" id="autotoc_md83"></a>
Operations requiring a color format conversion</h2>
<p>The following table describes supported <em><b>input</b></em> formats for operations requiring a color format conversion.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">nv12 </th><th class="markdownTableHeadNone">rgb-interleaved </th><th class="markdownTableHeadNone">rgb-planar  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p>The following table describes supported <em><b>output</b></em> formats for operations requiring a color format conversion.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">nv12 </th><th class="markdownTableHeadNone">rgb-interleaved </th><th class="markdownTableHeadNone">rgb-planar  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
</table>
<h2><a class="anchor" id="autotoc_md84"></a>
Operations &lt;em&gt;not&lt;/em&gt; requiring a color format conversion</h2>
<p>The following table describes supported image formats for operations <em>not</em> requiring a color format conversion, i.e. the input and output formats are identical. This could be e.g. a pure scaling operation.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">nv12 </th><th class="markdownTableHeadNone">rgb-interleaved </th><th class="markdownTableHeadNone">rgb-planar  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<h1><a class="anchor" id="autotoc_md85"></a>
Supported buffer properties</h1>
<p>This is an overview of what file descriptor properties are supported by the various preprocessing backends. Note that the <code>LAROD_FD_PROP_</code> prefix have been omitted from the table headers in the interest of brevity. Please see <a href="../lib/larod.h"><code>larod.h</code></a> for more info about the <code>LAROD_FD_PROD_*</code> flags.</p>
<h2><a class="anchor" id="autotoc_md86"></a>
When running jobs</h2>
<p>Please note that though several properties may be supported by a backend, a tensor buffer supplied for running a job need only have at least one of the backend's supported properties to be usable for the job. Having said that, each property comes with different implications on memory access performance.</p>
<h3><a class="anchor" id="autotoc_md87"></a>
Input tensors</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">READWRITE </th><th class="markdownTableHeadNone">MAP </th><th class="markdownTableHeadNone">DMABUF  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<h3><a class="anchor" id="autotoc_md88"></a>
Output tensors</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">READWRITE </th><th class="markdownTableHeadNone">MAP </th><th class="markdownTableHeadNone">DMABUF  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<h2><a class="anchor" id="autotoc_md89"></a>
When allocating tensors</h2>
<p>Please note that though several properties may be supported by a backend, it may not be possible to allocate buffers having all the properties at the same time.</p>
<h3><a class="anchor" id="autotoc_md90"></a>
Input tensors</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">READWRITE </th><th class="markdownTableHeadNone">MAP </th><th class="markdownTableHeadNone">DMABUF  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
</table>
<h3><a class="anchor" id="autotoc_md91"></a>
Output tensors</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Backend </th><th class="markdownTableHeadNone">READWRITE </th><th class="markdownTableHeadNone">MAP </th><th class="markdownTableHeadNone">DMABUF  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">libyuv </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ACE </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VProc </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OpenCL </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone">Yes </td><td class="markdownTableBodyNone"></td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="alarod_8h_html_a8f6f0898b3a3c25a07582687b6095265"><div class="ttname"><a href="larod_8h.html#a8f6f0898b3a3c25a07582687b6095265">larodJobRequest</a></div><div class="ttdeci">struct larodJobRequest larodJobRequest</div><div class="ttdoc">Type describing a job request.</div><div class="ttdef"><b>Definition:</b> larod.h:388</div></div>
<div class="ttc" id="alarod_8h_html_a28e4db02130ffb4c0a19fac84b698ce0"><div class="ttname"><a href="larod_8h.html#a28e4db02130ffb4c0a19fac84b698ce0">larodMapSetStr</a></div><div class="ttdeci">bool larodMapSetStr(larodMap *map, const char *key, const char *value, larodError **error)</div><div class="ttdoc">Add a string to a larodMap object.</div></div>
<div class="ttc" id="alarod_8h_html_af25e0293b11b12fb8e296fb20c828159"><div class="ttname"><a href="larod_8h.html#af25e0293b11b12fb8e296fb20c828159">larodCreateJobRequest</a></div><div class="ttdeci">larodJobRequest * larodCreateJobRequest(const larodModel *model, larodTensor **inputTensors, size_t numInputs, larodTensor **outputTensors, size_t numOutputs, larodMap *params, larodError **error)</div><div class="ttdoc">Create and initialize a job request handle.</div></div>
<div class="ttc" id="alarod_8h_html_a3e5686f34427aaa1a2476cc0991adf12"><div class="ttname"><a href="larod_8h.html#a3e5686f34427aaa1a2476cc0991adf12">larodMapSetIntArr2</a></div><div class="ttdeci">bool larodMapSetIntArr2(larodMap *map, const char *key, const int64_t value0, const int64_t value1, larodError **error)</div><div class="ttdoc">Add an integer array of two elements to a larodMap object.</div></div>
<div class="ttc" id="alarod_8h_html_a9617def81b934a2219d6a8f2a6ccdf7f"><div class="ttname"><a href="larod_8h.html#a9617def81b934a2219d6a8f2a6ccdf7f">larodLoadModel</a></div><div class="ttdeci">larodModel * larodLoadModel(larodConnection *conn, const int fd, const larodChip chip, const larodAccess access, const char *name, const larodMap *params, larodError **error)</div><div class="ttdoc">Load a new model.</div></div>
<div class="ttc" id="alarod_8h_html_a41ad6dc8e9f9ffebc03faf115167aba5afc936d97349d892279eec5c41c154d41"><div class="ttname"><a href="larod_8h.html#a41ad6dc8e9f9ffebc03faf115167aba5afc936d97349d892279eec5c41c154d41">LAROD_ACCESS_PRIVATE</a></div><div class="ttdeci">@ LAROD_ACCESS_PRIVATE</div><div class="ttdoc">Private access.</div><div class="ttdef"><b>Definition:</b> larod.h:101</div></div>
<div class="ttc" id="alarod_8h_html_a5d61d65903803a3c587e5830de34df24a0444d4c3c924311308e7bd61479dc99d"><div class="ttname"><a href="larod_8h.html#a5d61d65903803a3c587e5830de34df24a0444d4c3c924311308e7bd61479dc99d">LAROD_CHIP_LIBYUV</a></div><div class="ttdeci">@ LAROD_CHIP_LIBYUV</div><div class="ttdoc">CPU with libyuv.</div><div class="ttdef"><b>Definition:</b> larod.h:85</div></div>
<div class="ttc" id="alarod_8h_html_a480ba7618e79ad250c166c52d216ab79"><div class="ttname"><a href="larod_8h.html#a480ba7618e79ad250c166c52d216ab79">larodMap</a></div><div class="ttdeci">struct larodMap larodMap</div><div class="ttdoc">A type containing key-value pairs.</div><div class="ttdef"><b>Definition:</b> larod.h:408</div></div>
<div class="ttc" id="alarod_8h_html_a9e56e66ffecad46856d96bc289b6ce5a"><div class="ttname"><a href="larod_8h.html#a9e56e66ffecad46856d96bc289b6ce5a">larodModel</a></div><div class="ttdeci">struct larodModel larodModel</div><div class="ttdoc">A type representing a model.</div><div class="ttdef"><b>Definition:</b> larod.h:338</div></div>
<div class="ttc" id="alarod_8h_html_ab008dee48f6d1625ed351899492c53f1"><div class="ttname"><a href="larod_8h.html#ab008dee48f6d1625ed351899492c53f1">larodMapSetIntArr4</a></div><div class="ttdeci">bool larodMapSetIntArr4(larodMap *map, const char *key, const int64_t value0, const int64_t value1, const int64_t value2, const int64_t value3, larodError **error)</div><div class="ttdoc">Add an integer array of four elements to a larodMap object.</div></div>
<div class="ttc" id="alarod_8h_html_ac7cb26c7b2ef5c99507edd44e7727b0e"><div class="ttname"><a href="larod_8h.html#ac7cb26c7b2ef5c99507edd44e7727b0e">larodCreateMap</a></div><div class="ttdeci">larodMap * larodCreateMap(larodError **error)</div><div class="ttdoc">Create new larodMap.</div></div>
<div class="ttc" id="alarod_8h_html_a7c492dcfb18e0a32407dc6078bd50dbe"><div class="ttname"><a href="larod_8h.html#a7c492dcfb18e0a32407dc6078bd50dbe">larodRunJob</a></div><div class="ttdeci">bool larodRunJob(larodConnection *conn, const larodJobRequest *jobReq, larodError **error)</div><div class="ttdoc">Run a job on a loaded model.</div></div>
<div class="ttc" id="alarod_8h_html_aa6ff7fdb5a6d524d366c16df6856849f"><div class="ttname"><a href="larod_8h.html#aa6ff7fdb5a6d524d366c16df6856849f">larodSetJobRequestParams</a></div><div class="ttdeci">bool larodSetJobRequestParams(larodJobRequest *jobReq, const larodMap *params, larodError **error)</div><div class="ttdoc">Set additional parameters to a job request.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 15 2021 08:50:11 for liblarod by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
